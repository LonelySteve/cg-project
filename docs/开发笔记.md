# 开发笔记

## 目标

实现一个用以演示不同绘图算法的画板

## 使用技术栈

- TypeScript
- react
- Material-UI

## 需求分析

- 应用栏：用来展示项目名（仅此而已，没啥用）
- 属性面板
  - 当前元素名称下拉菜单：元素名称是唯一的，用户可以无法更改，输入一个不存在的名称会导致切换至未选中元素的状态
  - 操作按钮组
    - “新增”按钮：以当前选项添加一个指定元素到画板，只有当前处于未选中元素状态时才显示
    - “删除”按钮：从当前画板中移除该元素，只有当前处于选中元素状态时才显示
  - 指定当前绘制元素类型的下拉菜单
    - 线
    - 椭圆/圆
    - 图片
    - 文字
  - 当前层次：当未选中元素时，总是 -1 （表示即将处于最后一个），输入一个不合理的值会修正至最接近的限值
  - 颜色选取按钮组（边框颜色，填充颜色）：弹出颜色选取窗口，供用户改变当前所选取的颜色
  - 当前绘制元素参数选项组（内容受当前所选择的绘制元素类型影响）
    - 提供来源选项下拉菜单
      - 在画板中通过鼠标操作以确定参数
      - 手动输入（默认）
    - 参数
      - 线：起始点 终止点 线宽 RotaryInfo Rect
      - 椭圆/圆：中心点 半径 RotaryInfo Rect
      - 图片：图片源 尺寸 RotaryInfo Rect
      - 文字：内容 字体 尺寸 RotaryInfo Rect
  - 指定当前绘图算法的下拉菜单（内容受当前所选择的绘制元素类型影响）
    - 线：内置 DDA Bresenham
    - 椭圆/圆：内置
    - 图片：内置
    - 文字：内置
  - 绘图算法参数选项组（内容受当前所选择的绘图算法影响）
    - DDA: 取整
    - 内置: 抗锯齿

- 画板面板
  - 鼠标指针如果移动到一个元素上，则切换样式到手型
  - 选中一个元素触发前提：
    - 在一个元素上左击或右击
    - 在属性面板的“当前元素名称下拉菜单”中选中一个元素
  - 取消选中状态触发前提：
    - 在画板的任何空白部分左击或右击
  - 选中某个元素能使属性面板显示该元素的选项及参数
  - 在“提供来源选项下拉菜单”选项为“在画板中通过鼠标操作以确定参数”的前提下，选中元素并拖动鼠标则能使该元素发生位移，并能属性面板中实时看到参数变化
  - 右键菜单
    - 如果在一个元素上
      - 拷贝当前元素
      - 置于顶层
      - 置于底层
      - 删除
      - 切换绘图算法（含动态子菜单，内容受当前所选择的绘制元素影响）
    - 一般情况
      - 新增一个元素
      - 清空
      - 保存到本地
  - 按下 X 键打开悬浮放大镜（有点难）

### 补充描述

- 当属性面板中的任何一个参数发生改变，绑定的画板上的元素会随之更新
- Rect: 一种描述绘制区域的结构，由左上角坐标和宽高组成，我们并不希望重绘发生时更新整个画板的像素，这样会导致性能下降，根据这个参数可以进行局部重绘操作
- RotaryInfo: 一种描述旋转信息的结构，由中心点坐标和旋转角度组成（规定顺时针为正）

### 初步设计

